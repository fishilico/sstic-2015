\small{
\sciteb{\#!/usr/bin/env python3}\scitea{} \\
\sciteh{"""Decode the Rubber Ducky inject.bin compiled script"""}\scitea{} \\
\scitef{import}\scitea{ }\scitel{struct}\scitea{} \\
\scitef{import}\scitea{ }\scitel{sys}\scitea{} \\
\scitea{} \\
\sciteb{\# Build a (opcode, modifier)-to-char dictonary}\scitea{} \\
\scitel{OM2C}\scitea{ }\scitek{=}\scitea{ }\scitek{\{}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x1e}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'1'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x1e}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'!'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x1f}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'2'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x1f}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'$@$'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x20}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'3'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x20}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'\#'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x21}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'4'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x21}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'\$'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x22}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'5'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x22}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'\%'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x23}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'6'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x23}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'\^{ }'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x24}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'7'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x24}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'\&'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x25}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'8'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x25}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'*'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x26}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'9'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x26}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'('}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x27}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'0'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x27}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{')'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x28}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'[ENTER]{\textbackslash}n'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x29}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'[ESC]{\textbackslash}n'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x2b}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'{\textbackslash}t'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x2c}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{' '}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x2d}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'-'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x2d}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'\_'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x2e}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'='}\scitek{,}\scitea{ }\scitek{(}\scitec{0x2e}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'+'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x2f}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'['}\scitek{,}\scitea{ }\scitek{(}\scitec{0x2f}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'\{'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x30}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{']'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x30}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'\}'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x31}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'{\textbackslash}{\textbackslash}'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x31}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'|'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x33}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{':'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x33}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{';'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x34}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scited{"'"}\scitek{,}\scitea{ }\scitek{(}\scitec{0x34}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'"'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x35}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'`'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x35}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'\~{ }'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x36}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{','}\scitek{,}\scitea{ }\scitek{(}\scitec{0x36}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'$<$'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x37}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'.'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x37}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'$>$'}\scitek{,}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{(}\scitec{0x38}\scitek{,}\scitea{ }\scitec{0}\scitek{):}\scitea{ }\scitee{'/'}\scitek{,}\scitea{ }\scitek{(}\scitec{0x38}\scitek{,}\scitea{ }\scitec{2}\scitek{):}\scitea{ }\scitee{'?'}\scitek{,}\scitea{} \\
\scitek{\}}\scitea{} \\
\sciteb{\# Alphabet}\scitea{} \\
\scitef{for}\scitea{ }\scitel{i}\scitea{ }\scitef{in}\scitea{ }\scitel{range}\scitek{(}\scitec{26}\scitek{):}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{OM2C}\scitek{[(}\scitel{i}\scitea{ }\scitek{+}\scitea{ }\scitec{4}\scitek{,}\scitea{ }\scitec{0}\scitek{)]}\scitea{ }\scitek{=}\scitea{ }\scitel{chr}\scitek{(}\scitel{ord}\scitek{(}\scitee{'a'}\scitek{)}\scitea{ }\scitek{+}\scitea{ }\scitel{i}\scitek{)}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{OM2C}\scitek{[(}\scitel{i}\scitea{ }\scitek{+}\scitea{ }\scitec{4}\scitek{,}\scitea{ }\scitec{2}\scitek{)]}\scitea{ }\scitek{=}\scitea{ }\scitel{chr}\scitek{(}\scitel{ord}\scitek{(}\scitee{'A'}\scitek{)}\scitea{ }\scitek{+}\scitea{ }\scitel{i}\scitek{)}\scitea{} \\
\scitea{} \\
\scitel{delay\_time}\scitea{ }\scitek{=}\scitea{ }\scitec{0}\scitea{} \\
\scitef{with}\scitea{ }\scitel{open}\scitek{(}\scitee{'inject.bin'}\scitek{,}\scitea{ }\scitee{'rb'}\scitek{)}\scitea{ }\scitef{as}\scitea{ }\scitel{f}\scitek{:}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{while}\scitea{ }\scitel{True}\scitek{:}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{injectdata}\scitea{ }\scitek{=}\scitea{ }\scitel{f}\scitek{.}\scitel{read}\scitek{(}\scitec{2}\scitek{)}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{if}\scitea{ }\scitel{len}\scitek{(}\scitel{injectdata}\scitek{)}\scitea{ }\scitek{==}\scitea{ }\scitec{0}\scitek{:}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{break}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{opcode}\scitek{,}\scitea{ }\scitel{modifier}\scitea{ }\scitek{=}\scitea{ }\scitel{struct}\scitek{.}\scitel{unpack}\scitek{(}\scitee{'BB'}\scitek{,}\scitea{ }\scitel{injectdata}\scitek{)}\scitea{} \\
\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\sciteb{\# "DELAY" is encoded with successive opcode-0 commands}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{if}\scitea{ }\scitel{opcode}\scitea{ }\scitek{==}\scitea{ }\scitec{0}\scitek{:}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{delay\_time}\scitea{ }\scitek{+=}\scitea{ }\scitel{modifier}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{continue}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{if}\scitea{ }\scitel{delay\_time}\scitek{:}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{print}\scitek{(}\scited{"[DELAY \{\}]"}\scitek{.}\scitel{format}\scitek{(}\scitel{delay\_time}\scitek{))}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{delay\_time}\scitea{ }\scitek{=}\scitea{ }\scitec{0}\scitea{} \\
\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\sciteb{\# WIN key + letter is encoded with modifier 8}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{if}\scitea{ }\scitel{modifier}\scitea{ }\scitek{\&}\scitea{ }\scitec{8}\scitek{:}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{c}\scitea{ }\scitek{=}\scitea{ }\scitel{OM2C}\scitek{.}\scitel{get}\scitek{((}\scitel{opcode}\scitek{,}\scitea{ }\scitel{modifier}\scitea{ }\scitek{\&}\scitea{ }\scitek{\~{ }}\scitec{8}\scitek{))}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{if}\scitea{ }\scitel{c}\scitea{ }\scitef{is}\scitea{ }\scitef{not}\scitea{ }\scitel{None}\scitek{:}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{print}\scitek{(}\scited{"[WIN \{\}]"}\scitek{.}\scitel{format}\scitek{(}\scitel{c}\scitek{))}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{continue}\scitea{} \\
\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{sys}\scitek{.}\scitel{stdout}\scitek{.}\scitel{write}\scitek{(}\scitel{OM2C}\scitek{.}\scitel{get}\scitek{((}\scitel{opcode}\scitek{,}\scitea{ }\scitel{modifier}\scitek{)))}\scitea{} \\
\scitea{}
} %end small
