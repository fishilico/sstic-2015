\small{
\scitej{\#include $<$stdint.h$>$} \\
\scitej{\#include $<$string.h$>$} \\
\scitea{} \\
\scitef{void}\scitea{ }\scitel{decrypt}\scitek{(}\scitef{const}\scitea{ }\scitel{uint8\_t}\scitea{ }\scitel{argkey}\scitek{[}\scitee{12}\scitek{],}\scitea{ }\scitef{const}\scitea{ }\scitel{uint8\_t}\scitea{ }\scitek{*}\scitel{src}\scitek{,}\scitea{ }\scitel{uint8\_t}\scitea{ }\scitek{*}\scitel{dst}\scitek{,}\scitea{ }\scitel{uint32\_t}\scitea{ }\scitel{size}\scitek{)}\scitea{} \\
\scitek{\{}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\sciteb{/* Local state of each transputer which uses one */}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{uint8\_t}\scitea{ }\scitel{trans4w1}\scitea{ }\scitek{=}\scitea{ }\scitee{0}\scitek{,}\scitea{ }\scitel{trans5w1}\scitea{ }\scitek{=}\scitea{ }\scitee{0}\scitek{;}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{uint16\_t}\scitea{ }\scitel{trans6w1}\scitea{ }\scitek{=}\scitea{ }\scitee{0}\scitek{;}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{uint8\_t}\scitea{ }\scitel{trans8w4}\scitea{ }\scitek{=}\scitea{ }\scitee{0}\scitek{,}\scitea{ }\scitel{trans8w5sums}\scitek{[}\scitee{4}\scitek{]}\scitea{ }\scitek{=}\scitea{ }\scitek{\{\};}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{uint8\_t}\scitea{ }\scitel{trans10w2}\scitea{ }\scitek{=}\scitea{ }\scitee{0}\scitek{,}\scitea{ }\scitel{trans10w4buff0}\scitek{[}\scitee{4}\scitek{]}\scitea{ }\scitek{=}\scitea{ }\scitek{\{\},}\scitea{ }\scitel{trans10w4buffers}\scitek{[}\scitee{4}\scitea{ }\scitek{*}\scitea{ }\scitee{12}\scitek{]}\scitea{ }\scitek{=}\scitea{ }\scitek{\{\};}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{uint8\_t}\scitea{ }\scitel{trans11next}\scitea{ }\scitek{=}\scitea{ }\scitee{0}\scitek{;}\scitea{} \\
\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{uint32\_t}\scitea{ }\scitel{byteidx}\scitek{;}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{uint8\_t}\scitea{ }\scitel{key}\scitek{[}\scitee{12}\scitek{],}\scitea{ }\scitel{i}\scitek{;}\scitea{} \\
\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\sciteb{/* Copy the key in a local buffer which is modified */}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{memcpy}\scitek{(}\scitel{key}\scitek{,}\scitea{ }\scitel{argkey}\scitek{,}\scitea{ }\scitee{12}\scitek{);}\scitea{} \\
\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\sciteb{/* Initialize transputer 6 state with the initial key buffer */}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{for}\scitea{ }\scitek{(}\scitel{i}\scitea{ }\scitek{=}\scitea{ }\scitee{0}\scitek{;}\scitea{ }\scitel{i}\scitea{ }\scitek{$<$}\scitea{ }\scitee{12}\scitek{;}\scitea{ }\scitel{i}\scitek{++)}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{trans6w1}\scitea{ }\scitek{+=}\scitea{ }\scitel{key}\scitek{[}\scitel{i}\scitek{];}\scitea{} \\
\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{for}\scitea{ }\scitek{(}\scitel{byteidx}\scitea{ }\scitek{=}\scitea{ }\scitee{0}\scitek{;}\scitea{ }\scitel{byteidx}\scitea{ }\scitek{$<$}\scitea{ }\scitel{size}\scitek{;}\scitea{ }\scitel{byteidx}\scitek{++)}\scitea{ }\scitek{\{}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{const}\scitea{ }\scitel{uint32\_t}\scitea{ }\scitel{keyidx}\scitea{ }\scitek{=}\scitea{ }\scitel{byteidx}\scitea{ }\scitek{\%}\scitea{ }\scitee{12}\scitek{;}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{uint8\_t}\scitea{ }\scitel{transres}\scitek{,}\scitea{ }\scitel{s0\_5}\scitea{ }\scitek{=}\scitea{ }\scitee{0}\scitek{,}\scitea{ }\scitel{s6\_11}\scitea{ }\scitek{=}\scitea{ }\scitee{0}\scitek{,}\scitea{ }\scitel{s0\_11}\scitek{,}\scitea{ }\scitel{s\_t10}\scitea{ }\scitek{=}\scitea{ }\scitee{0}\scitek{;}\scitea{} \\
\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\sciteb{/* Decrypt one byte (code in transputer 0) */}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{*(}\scitel{dst}\scitek{++)}\scitea{ }\scitek{=}\scitea{ }\scitek{*(}\scitel{src}\scitek{++)}\scitea{ }\scitek{\^{ }}\scitea{ }\scitek{(}\scitel{keyidx}\scitea{ }\scitek{+}\scitea{ }\scitee{2}\scitea{ }\scitek{*}\scitea{ }\scitel{key}\scitek{[}\scitel{keyidx}\scitek{]);}\scitea{} \\
\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\sciteb{/* Compute sums of key[0] to key[5], key[6] to key[11]... */}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{for}\scitea{ }\scitek{(}\scitel{i}\scitea{ }\scitek{=}\scitea{ }\scitee{0}\scitek{;}\scitea{ }\scitel{i}\scitea{ }\scitek{$<$}\scitea{ }\scitee{6}\scitek{;}\scitea{ }\scitel{i}\scitek{++)}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{s0\_5}\scitea{ }\scitek{+=}\scitea{ }\scitel{key}\scitek{[}\scitel{i}\scitek{];}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{for}\scitea{ }\scitek{(}\scitel{i}\scitea{ }\scitek{=}\scitea{ }\scitee{6}\scitek{;}\scitea{ }\scitel{i}\scitea{ }\scitek{$<$}\scitea{ }\scitee{12}\scitek{;}\scitea{ }\scitel{i}\scitek{++)}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{s6\_11}\scitea{ }\scitek{+=}\scitea{ }\scitel{key}\scitek{[}\scitel{i}\scitek{];}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\sciteb{/* ... and from key[0] to key[11] */}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{s0\_11}\scitea{ }\scitek{=}\scitea{ }\scitel{s0\_5}\scitea{ }\scitek{+}\scitea{ }\scitel{s6\_11}\scitek{;}\scitea{} \\
\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{trans6w1}\scitea{ }\scitek{=}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{((}\scitel{trans6w1}\scitea{ }\scitek{\&}\scitea{ }\scitee{0x8000}\scitek{)}\scitea{ }\scitek{$>$$>$}\scitea{ }\scitee{15}\scitek{)}\scitea{ }\scitek{\^{ }}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{((}\scitel{trans6w1}\scitea{ }\scitek{\&}\scitea{ }\scitee{0x4000}\scitek{)}\scitea{ }\scitek{$>$$>$}\scitea{ }\scitee{14}\scitek{)}\scitea{ }\scitek{\^{ }}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{((}\scitel{trans6w1}\scitea{ }\scitek{$<$$<$}\scitea{ }\scitee{1}\scitek{)}\scitea{ }\scitek{\&}\scitea{ }\scitee{0xffff}\scitek{);}\scitea{} \\
\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{trans8w5sums}\scitek{[}\scitel{trans8w4}\scitek{]}\scitea{ }\scitek{=}\scitea{ }\scitel{s0\_11}\scitek{;}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{trans8w4}\scitea{ }\scitek{=}\scitea{ }\scitek{(}\scitel{trans8w4}\scitea{ }\scitek{+}\scitea{ }\scitee{1}\scitek{)}\scitea{ }\scitek{\%}\scitea{ }\scitee{4}\scitek{;}\scitea{} \\
\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{trans10w4buff0}\scitek{[}\scitel{trans10w2}\scitek{]}\scitea{ }\scitek{=}\scitea{ }\scitel{key}\scitek{[}\scitee{0}\scitek{];}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{memcpy}\scitek{(}\scitel{trans10w4buffers}\scitea{ }\scitek{+}\scitea{ }\scitee{12}\scitea{ }\scitek{*}\scitea{ }\scitel{trans10w2}\scitek{,}\scitea{ }\scitel{key}\scitek{,}\scitea{ }\scitee{12}\scitek{);}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{trans10w2}\scitea{ }\scitek{=}\scitea{ }\scitek{(}\scitel{trans10w2}\scitea{ }\scitek{+}\scitea{ }\scitee{1}\scitek{)}\scitea{ }\scitek{\%}\scitea{ }\scitee{4}\scitek{;}\scitea{} \\
\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{transres}\scitea{ }\scitek{=}\scitea{ }\scitek{(}\scitel{trans6w1}\scitea{ }\scitek{\&}\scitea{ }\scitee{0xff}\scitek{)}\scitea{ }\scitek{\^{ }}\scitea{ }\scitel{s0\_5}\scitea{ }\scitek{\^{ }}\scitea{ }\scitel{s6\_11}\scitea{ }\scitek{\^{ }}\scitea{ }\scitel{key}\scitek{[}\scitel{trans11next}\scitek{];}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{transres}\scitea{ }\scitek{\^{ }=}\scitea{ }\scitel{key}\scitek{[(}\scitel{key}\scitek{[}\scitee{0}\scitek{]}\scitea{ }\scitek{\^{ }}\scitea{ }\scitel{key}\scitek{[}\scitee{3}\scitek{]}\scitea{ }\scitek{\^{ }}\scitea{ }\scitel{key}\scitek{[}\scitee{7}\scitek{])}\scitea{ }\scitek{\%}\scitea{ }\scitee{12}\scitek{];}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{trans11next}\scitea{ }\scitek{=}\scitea{ }\scitek{(}\scitel{key}\scitek{[}\scitee{1}\scitek{]}\scitea{ }\scitek{\^{ }}\scitea{ }\scitel{key}\scitek{[}\scitee{5}\scitek{]}\scitea{ }\scitek{\^{ }}\scitea{ }\scitel{key}\scitek{[}\scitee{9}\scitek{])}\scitea{ }\scitek{\%}\scitea{ }\scitee{12}\scitek{;}\scitea{} \\
\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{for}\scitea{ }\scitek{(}\scitel{i}\scitea{ }\scitek{=}\scitea{ }\scitee{0}\scitek{;}\scitea{ }\scitel{i}\scitea{ }\scitek{$<$}\scitea{ }\scitee{12}\scitek{;}\scitea{ }\scitel{i}\scitek{++)}\scitea{ }\scitek{\{}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{uint8\_t}\scitea{ }\scitel{k}\scitea{ }\scitek{=}\scitea{ }\scitel{key}\scitek{[}\scitel{i}\scitek{];}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{trans4w1}\scitea{ }\scitek{+=}\scitea{ }\scitel{k}\scitek{;}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{trans5w1}\scitea{ }\scitek{\^{ }=}\scitea{ }\scitel{k}\scitek{;}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{transres}\scitea{ }\scitek{\^{ }=}\scitea{ }\scitel{k}\scitea{ }\scitek{$<$$<$}\scitea{ }\scitek{(}\scitel{i}\scitea{ }\scitek{\&}\scitea{ }\scitee{7}\scitek{);}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{\}}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{transres}\scitea{ }\scitek{\^{ }=}\scitea{ }\scitel{trans4w1}\scitea{ }\scitek{\^{ }}\scitea{ }\scitel{trans5w1}\scitek{;}\scitea{} \\
\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{for}\scitea{ }\scitek{(}\scitel{i}\scitea{ }\scitek{=}\scitea{ }\scitee{0}\scitek{;}\scitea{ }\scitel{i}\scitea{ }\scitek{$<$}\scitea{ }\scitee{4}\scitek{;}\scitea{ }\scitel{i}\scitek{++)}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{transres}\scitea{ }\scitek{\^{ }=}\scitea{ }\scitel{trans8w5sums}\scitek{[}\scitel{i}\scitek{];}\scitea{} \\
\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\sciteb{/* Transputer 10 sum */}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitef{for}\scitea{ }\scitek{(}\scitel{i}\scitea{ }\scitek{=}\scitea{ }\scitee{0}\scitek{;}\scitea{ }\scitel{i}\scitea{ }\scitek{$<$}\scitea{ }\scitee{4}\scitek{;}\scitea{ }\scitel{i}\scitek{++)}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{s\_t10}\scitea{ }\scitek{+=}\scitea{ }\scitel{trans10w4buff0}\scitek{[}\scitel{i}\scitek{];}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{transres}\scitea{ }\scitek{\^{ }=}\scitea{ }\scitel{trans10w4buffers}\scitek{[}\scitee{12}\scitea{ }\scitek{*}\scitea{ }\scitek{(}\scitel{s\_t10}\scitea{ }\scitek{\&}\scitea{ }\scitee{3}\scitek{)}\scitea{ }\scitek{+}\scitea{ }\scitek{((}\scitel{s\_t10}\scitea{ }\scitek{$>$$>$}\scitea{ }\scitee{4}\scitek{)}\scitea{ }\scitek{\%}\scitea{ }\scitee{12}\scitek{)];}\scitea{} \\
\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\sciteb{/* Transputer 0 combines the results for all transputers into one byte of the key */}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitel{key}\scitek{[}\scitel{keyidx}\scitek{]}\scitea{ }\scitek{=}\scitea{ }\scitel{transres}\scitek{;}\scitea{} \\
\scitea{{\hspace*{1.2ex}}{\hspace*{1.2ex}}{\hspace*{1.2ex}} }\scitek{\}}\scitea{} \\
\scitek{\}}\scitea{} \\
\scitea{}
} %end small
